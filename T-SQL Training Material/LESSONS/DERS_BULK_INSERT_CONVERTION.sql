
SELECT COUNT(*)
FROM dbo.URUNLER


SELECT COUNT(*)
FROM dbo.URUNLER_2019

SELECT 1055751 + 766454


---------

ALTER TABLE dbo.URUNLER
DROP COLUMN column20

--- TUTAR

SELECT TRY_CAST(TUTAR AS money), *
FROM [dbo].[URUNLER]
WHERE TRY_CAST(TUTAR AS money) IS NULL

SELECT LEFT(LTRIM(RTRIM(TUTAR)), LEN(LTRIM(RTRIM(TUTAR))) - 1),*
FROM [dbo].[URUNLER]
WHERE RIGHT(LTRIM(RTRIM(TUTAR)),1) = '-'

UPDATE [dbo].[URUNLER]
SET TUTAR = LEFT(LTRIM(RTRIM(TUTAR)), LEN(LTRIM(RTRIM(TUTAR))) - 1)
WHERE RIGHT(LTRIM(RTRIM(TUTAR)),1) = '-'

ALTER TABLE [dbo].[URUNLER]
ALTER COLUMN TUTAR MONEY NOT NULL

----- KDVLI TUTAR


SELECT TRY_CAST(KDVLI_TUTAR AS money), *
FROM [dbo].[URUNLER]
WHERE TRY_CAST(KDVLI_TUTAR AS money) IS NULL

SELECT LEFT(LTRIM(RTRIM(KDVLI_TUTAR)), LEN(LTRIM(RTRIM(KDVLI_TUTAR))) - 1),*
FROM [dbo].[URUNLER]
WHERE RIGHT(LTRIM(RTRIM(KDVLI_TUTAR)),1) = '-'

UPDATE [dbo].[URUNLER]
SET KDVLI_TUTAR = LEFT(LTRIM(RTRIM(KDVLI_TUTAR)), LEN(LTRIM(RTRIM(KDVLI_TUTAR))) - 1)
WHERE RIGHT(LTRIM(RTRIM(KDVLI_TUTAR)),1) = '-'

ALTER TABLE [dbo].[URUNLER]
ALTER COLUMN KDVLI_TUTAR MONEY NOT NULL

-- GIRIS_TARIHI

SELECT TRY_CONVERT(DATE, GIRIS_TARIHI,104),*
FROM dbo.URUNLER
WHERE TRY_CONVERT(DATE, GIRIS_TARIHI,104) IS NULL


SELECT TRY_CONVERT(DATE, GIRIS_TARIHI,104),
	   GIRIS_TARIHI,
	   CONVERT(DATE, GIRIS_TARIHI,104)
FROM dbo.URUNLER
WHERE TRY_CONVERT(DATE, GIRIS_TARIHI,104) IS NULL


--ALTER TABLE dbo.URUNLER
--ALTER COLUMN GIRIS_TARIHI DATE


ALTER TABLE dbo.URUNLER
ADD GIRIS_TARIHI_YENI DATE NULL

UPDATE dbo.URUNLER
SET GIRIS_TARIHI_YENI = CONVERT(DATE, GIRIS_TARIHI,104)

ALTER TABLE dbo.URUNLER
DROP COLUMN GIRIS_TARIHI

EXEC sp_rename 'dbo.URUNLER.GIRIS_TARIHI_YENI', 'GIRIS_TARIHI', 'COLUMN' ;

SELECT TOP 100 * FROM dbo.URUNLER

-- ISLEM_TARIHI


SELECT TRY_CONVERT(DATE, ISLEM_TARIHI,104),*
FROM dbo.URUNLER
WHERE TRY_CONVERT(DATE, ISLEM_TARIHI,104) IS NULL


SELECT TRY_CONVERT(DATE, ISLEM_TARIHI,104),
	   ISLEM_TARIHI,
	   CONVERT(DATE, ISLEM_TARIHI,104)
FROM dbo.URUNLER
WHERE TRY_CONVERT(DATE, ISLEM_TARIHI,104) IS NULL


--ALTER TABLE dbo.URUNLER
--ALTER COLUMN GIRIS_TARIHI DATE


ALTER TABLE dbo.URUNLER
ADD ISLEM_TARIHI_YENI DATE NULL

UPDATE dbo.URUNLER
SET ISLEM_TARIHI_YENI = CONVERT(DATE, ISLEM_TARIHI,104)

ALTER TABLE dbo.URUNLER
DROP COLUMN ISLEM_TARIHI

EXEC sp_rename 'dbo.URUNLER.ISLEM_TARIHI_YENI', 'ISLEM_TARIHI', 'COLUMN' ;


----- MIKTAR


SELECT TRY_CONVERT(NUMERIC(10,3), REPLACE(TRIM(MIKTAR),',','.')),
	   REPLACE(TRIM(MIKTAR),',','.'),
	   MIKTAR,* 
FROM dbo.URUNLER

UPDATE dbo.URUNLER
SET MIKTAR = REPLACE(TRIM(MIKTAR),',','.')


SELECT TRY_CONVERT(NUMERIC(10,3), MIKTAR),
	   MIKTAR,* 
FROM dbo.URUNLER
WHERE TRY_CONVERT(NUMERIC(10,3), MIKTAR) IS NULL


---   sondaki - işareti sorunu
SELECT LEFT(LTRIM(RTRIM(MIKTAR)), LEN(LTRIM(RTRIM(MIKTAR))) - 1),*
FROM [dbo].[URUNLER]
WHERE RIGHT(LTRIM(RTRIM(MIKTAR)),1) = '-'


UPDATE [dbo].[URUNLER]
SET MIKTAR = LEFT(LTRIM(RTRIM(MIKTAR)), LEN(LTRIM(RTRIM(MIKTAR))) - 1)
WHERE RIGHT(LTRIM(RTRIM(MIKTAR)),1) = '-'

-- baştaki * işareti sornu


SELECT TRY_CONVERT(NUMERIC(10,3), MIKTAR),
	   MIKTAR,* 
FROM dbo.URUNLER
WHERE TRY_CONVERT(NUMERIC(10,3), MIKTAR) IS NULL

SELECT LEFT(LTRIM(RTRIM(MIKTAR)), 1),
	   REPLACE(MIKTAR,'*',''),
	   MIKTAR,*
FROM [dbo].[URUNLER]
WHERE LEFT(LTRIM(RTRIM(MIKTAR)), 1) = '*'


UPDATE [dbo].[URUNLER]
SET MIKTAR = REPLACE(MIKTAR,'*','')
WHERE LEFT(LTRIM(RTRIM(MIKTAR)), 1) = '*'

ALTER TABLE dbo.URUNLER
ALTER COLUMN MIKTAR NUMERIC(10,3)




















